---
title: "Getting Started with ACLIM Bering10K ROMSNPZ Level3 indices (FOR INTERNAL ACLIM USE ONLY)
"
author: "Kirstin Holsman"
output:
  html_document:
    df_print: kable
    fig_caption: yes
    theme: flatly
    toc: true
    toc_float: true
  pdf_document:
    fig_caption: yes
    fig_height: 4
    fig_width: 5
    highlight: tango
    keep_tex: yes
    latex_engine: xelatex
    toc: TRUE
  header-includes:
  - \usepackage{inputenc}
  - \usepackage{unicode-math}
  - \pagenumbering{gobble}
  word_document:
    fig_caption: yes
    fig_width: 4
    keep_md: yes
---

```{r startup, eval=T, echo=F}
 #source("R/make.R")       # loads packages, data, setup, etc.
 knitr::opts_chunk$set(echo = TRUE, fig.align="center")
 thisYr <- format(Sys.time(), "%Y")
 today  <- format(Sys.time(), "%b %d, %Y")
 
```


<!-- ```{r, echo=FALSE, fig.align='center'} -->
<!-- include_graphics("Figs/ACLIM_logo.jpg") -->
<!-- ``` -->


![.](Figs/ACLIM_logo.jpg){ width=20%}

**Getting Started with ACLIM Bering10K ROMSNPZ Level3 indices**  
**(FOR INTERNAL ACLIM USE ONLY)**  
[**ACLIM Repo: github.com/kholsman/ACLIM2**](https://github.com/kholsman/ACLIM2 "ACLIM2 Repo")  
  Repo maintained by:  
  Kirstin Holsman  
  Alaska Fisheries Science Center  
  NOAA Fisheries, Seattle WA  
  **[kirstin.holsman@noaa.gov](kirstin.holsman@noaa.gov)**  
  *Last updated: `r today`*

# 1. ACLIM data and code Overview

This is an overview of ACLIM plotting code and "canned" Rdata files generated from the downscaled ROMSNPZ modeling work ACLIM modelers Drs. Hermann, Cheng, Kearney,Pilcher, and Aydin. Dr. Kelly Kearney has recently dedicated significant time and energy towards organizing and documenting the ROMSNPZ output, especially as it pertains to the ACLIM project. We strongly recommend reviewing this [**documentation**](https://beringnpz.github.io/roms-bering-sea/B10K-dataset-docs/) before using the data in order to understand the origin of the indices and their present level of skill and validation, which varies considerably across indices and in space and time.

The Bering10K ROMSNPZ documentation can be accessed on the main [**documentation webpage**](https://beringnpz.github.io/roms-bering-sea/B10K-dataset-docs/). The webpage is maintained by Kelly Kearney and regularly updated with new documentation, including the following core documents (also linked in the [**00_ACLIM_shared/02_Data**](https://drive.google.com/drive/u/0/folders/0Bx7wdZllbuF9eDJndkhCS2EwQUk) folder):

[**The Bering10K Dataset documentation**](https://drive.google.com/file/d/1GlITTIvbs2gRBMNIxdDI15cZU6mH4ckg/view): A pdf describing the dataset, including:

1. A description of the various simulations (base model versions, parent model forcing datasets, and biological modules) and the output naming scheme for each.

2. A tutorial on working with the curvilinear, sigma-coordinate ROMS spatial grid, aimed at those who will be working with data on the native grid.

3. An overview of the ACLIM index dataset; this is a set of time series derived from the Bering10K output and intended for Alaska Climate Integrated Modeling (ACLIM) collaborators.

[**Bering10K Simulaton Variables**](https://drive.google.com/file/d/1C1FCxRMBm0uBv2wEKwrGfHmLnjt_gFvG/view): A spreadsheet listing all simulations and the archived output variables associated with each, updated periodically as new simulations are run or new variables are made available. Note that this includes both data available on both public and private servers (see below).
Please also see the Literature page for a list scientific publications related to the model, including model description and skill assessment.

## 1.1. Downscaled models and carbon scenarios

The full ACLIM "suite" of models include are summarized in the following table of downscaled models based on boundary conditions forced by General Circulation Models (GCM) run under Coupled Model Intercomparison Project (CMIP) phase 5 (5th IPCCAssessment Report) or phase 6 (6th IPCC Assessment Report; "AR") global carbon mitigation scenarios. For full details see the Kearney 2021 Tech. Memo.

### Table 1: Summary of ROMSNPZ downscaled model runs 
CMIP| GCM    |Scenario    |Def              |Years      |Model |Status|Source
--|--|------|--------|---------   | ---------------|----------|------|------|
5 | GFDL    |RCP 4.5    | Med. mitigation |2006 - 2099|H16      |ACLIM/FATE |Public
5 | GFDL    |RCP 8.5    | High baseline   |2006 - 2099|H16      |ACLIM/FATE |Public
5 | GFDL    |RCP 8.5bio*| High baseline   |2006 - 2099|H16      |ACLIM/FATE |Public
5 | MIROC   |RCP 4.5    | Med. mitigation |2006 - 2099|H16      |ACLIM/FATE |Public
5 | MIROC   |RCP 8.5    | High baseline   |2006 - 2099|H16      |ACLIM/FATE |Public
5 | CESM    |RCP 4.5    | Med. mitigation |2006 - 2099|H16      |ACLIM/FATE |Public
5 | CESM    |RCP 8.5    | High baseline   |2006 - 2080|H16      |ACLIM/FATE |Public
5 | CESM    |RCP 8.5bio*| High baseline   |2006 - 2099|H16      |ACLIM/FATE |Public
 ||CORECFS  | Reanalysis| Hindcast        |1970 - 2018|H16      |ACLIM      |Public
 ||CORECFS  |Reanalysis | Hindcast        |1970 - 2020|K20      |ACLIM2/RTAP|Public
6| CESM     |SSP585     | High baseline   |2014 - 2099|K20P19   |ACLIM2/RTAP|Embargo
6| CESM     |SSP126     | High Mitigation |2014 - 2099|K20P19   |ACLIM2/RTAP|Embargo
6| CESM     |Historical | Historical      |1980 - 2014|K20P19   |ACLIM2/RTAP|Embargo
6| GFDL     |SSP585     | High baseline   |2014 - 2099|K20P19   |ACLIM2/RTAP|Embargo
6| GFDL     |SSP126     | High Mitigation |2014 - 2099|K20P19   |ACLIM2/RTAP|Embargo
6| GFDL     |Historical | Historical      |1980 - 2014|K20P19   |ACLIM2/RTAP|Embargo
6| MIROC    |SSP585     | High baseline   |2014 - 2099|K20P19   |ACLIM2/RTAP|Embargo
6| MIROC    |SSP126     | High Mitigation |2014 - 2099|K20P19   |ACLIM2/RTAP|Embargo
6| MIROC    |Historical | Historical      |1980 - 2014|K20P19   |ACLIM2/RTAP|Embargo  
*"bio" = nutrient forcing on boundary conditions

## 1.2. More information on the BERING10K ROMSNPZ model

### 1.2.1. The Bering 10K Model (v. H16) with 10 depth layers:  

The H16 model is the original BSIERP era 10 depth layer model with a 10 Km grid. This version was used in ACLIM1.0 to dynamically downscaled 3 global circulation models (GCMs) under two CMIP5 representative carbon pathways (RCP): RCP 4.5 or "moderate global carbon mitigation" and RCP 8.5 "high baseline global carbon emissions". Details of the model and projections can be found in:

#### Hindcast (1979-2012; updated to 2016 during ACLIM 1.0):  

Hermann, A. J., G. A. Gibson, N. A. Bond, E. N. Curchitser, K. Hedstrom, W. Cheng, M. Wang, E. D. Cokelet, P. J. Stabeno, and K. Aydin. 2016. Projected future biophysical states of the Bering Sea. Deep Sea Research Part II: Topical Studies in Oceanography 134:30–47.[doi:10.1016/j.dsr2.2015.11.001](http://dx.doi.org/10.1016/j.dsr2.2015.11.001 "doi:10.1016/j.dsr2.2015.11.001")

#### Projections of the H16 10 layer model using CMIP5 scenarios:  

Hermann, A. J., G. A. Gibson, W. Cheng, I. Ortiz, K. Aydin, M. Wang, A. B. Hollowed, K. K. Holsman, and S. Sathyendranath. 2019. Projected biophysical conditions of the Bering Sea to 2100 under multiple emission scenarios. ICES Journal of Marine Science 76:1280–1304.[doi:10.1093/icesjms/fsz043](https://academic.oup.com/icesjms/article/76/5/1280/5477847?login=true "doi:10.1093/icesjms/fsz043"))

### 1.2.2. The Bering 10K Model (v. K20) with 30 depth layers and other advancements:

The Bering10K model was subsequently updated by Kearney et al. 2020 (30 layer and other NPZ updates) and Pilcher et al.2019 (OA and O2 dynamics) and this version is used for the projections in ACLIM2.0 under CMIP6.


#### Projections of the K20 30 layer model using CMIP6 scenarios:

Hermann et al. in prep
Cheng et al. in prep
Kearney et al. in prep
Pilcher et al. in prep (CMIP5 K20 projections) (ACLIM indices avail by permission only)

# 2. Getting started with Level3 ACLIM Indices


## 2.1 Information about ACLIM Level 3 indices

Level 3 indices can be used to generate seasonal, monthly, and annual indices (like those reported in Reum et al. 2020, Holsman et al. 2020). In section 3 below we explore these indices in more detail using R, including using (2) above to generate weekly, monthly, and seasonal indices (e.g. Fall Zooplankton) for use in biological models. In section 3 below we explore these indices in more detail using R, including using (2) above to generate weekly, monthly, and seasonal indices (e.g. Fall Zooplankton) for use in biological models. 

Please be sure to coordinate with ROMSNPZ modeling team members to ensure data is applied appropriately. If you need access to the raw ROMSNPZ files (netcdf, non-regridded large files located on MOX). Please contact  [**Al Hermann**](albert.j.hermann@noaa.gov) or [**Kelly Kearney**](kelly.kearney@noaa.gov).

**IMPORTANT**  
The ACLIM indices are stored as netcdf files (.nc) format in the Data folder of the ACLIM shared google drive or available on the new PMEL web-based portal. Please note that while the CMIP5 set is now public (Hermann et al. 2019) **the CMIP6 suite is under embargo for QAQC and should not be shared outside of the ACLIM group**. Al, Wei, Kelly, Darren, and Kerim are in the process of synthesizing and publishing the CMIP6 data (goal is spring 2021 for submission), following those publications the data will be made accessible to the public via the PMEL data portal, as is the case for the CMIP5 data and public hindcasts. It is strongly recommended that you include at least one (ideally multiple) authors from the ROMSNPZ team as co-author on your paper if you are linking to this data, this is especially the case for the CMIP6 data. There are multiple spatial and temporal caveats that are best described in discussions with the authors of these data and inclusion as co-authors will facilitate appropriate application and interpretation of the ROMSNPZ data.

## 2.2. Step 1: Clone the ACLIM2 GitHub code repo to your local directory:

First clone the ACLIM ROMSNPZ repo. This repo will open and explore the netcdf (.nc) files in R and produce plots and standardized outputs for ACLIM analyses. Some standardized tools are included as functions in this repo including spatial averaging for seasonal, monthly and annual indices (e.g., Fall zooplankton biomass), as well as bias correction for projections (see Holsman et al. 2020 and Reum et al. 2020 for ACLIM 1.0 bias correction methods). The repo also includes a Rshiny interactive exploratory graphing tool which can be viewed online [**at this link**](). 

### 2.1.1 Option 1: R() to download from github:

```{r gitdwnld, eval = FALSE,echo =T}

    # Specify the download directory
    main_nm       <- "ACLIM2"
    download_path <- path.expand("~/desktop")
    dest_fldr     <- file.path(download_path,main_nm)
    
    url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
    dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
    download.file(url=url, destfile=dest_file)
    
    # unzip the .zip file
    setwd(download_path)
    unzip (dest_file, exdir = "./",overwrite = T)
    #rename the unzipped folder from ACLIM2-main to ACLIM2
    file.rename(paste0(main_nm,"-main"), main_nm)
    setwd(main_nm)
    
```

If you have Rstudio installed you can double click on the ACLIM2.Rproj and use Rstudio to manage your plotting and files (recommended).

### 2.1.2 Option 2: Manually download from github repo using:

Select `Download ZIP` from the upper right hand side of the repo page :[**github.com/kholsman/ACLIM2**](https://github.com/kholsman/ACLIM2 "ACLIM2 Repo") and save it to your local directory: `~[YOURPATH]/ACLIM2`.

![](Figs/clone.jpg){ width=40% }

## 2.3. Step 2: Download Level 3  indices:


### 2.3.1 Option 1: Download from ACLIM google drive (public CMIP5 and embargoed ACLIM CMIP6)

Data files are too large to store in the GitHub repository and are instead saved in the shared ACLIM data folder. For most applications you can use the ACLIM level3 post-processed indices available on the shared ACLIM drive in the root google drive data folder: [**00_ACLIM_shared>02_DATA**](https://drive.google.com/drive/u/0/folders/0Bx7wdZllbuF9eDJndkhCS2EwQUk "00_ACLIM_shared>02_DATA"). 

The `Newest` folder is organized by Bering10K version, General Circulation Model (GCM) and carbon scenario, e.g. `B10K-H16_CMIP5_CESM_rcp45`. Within each folder the following subfolders are:

* `Level1`: (Empty; not copied from Mox)
* `Level2`: (Empty; not copied from Mox)
* `Level3`: 2 files (`ACLIMsurveyrep_B10K-x.nc` and `ACLIMregion_B10K-x.nc` )

1) `ACLIMsurveyrep_B10K-x.nc` contains summer groundfish trawl "survey replicated" indices (using mean date and lat lon) *(Note that the resampling stations need to be removed before creating bottom temperature maps)*  
2) `ACLIMregion_B10K-x.nc`: contains weekly "strata" values *(Note that area weighting should be used to combine values across multiple strata)*

<!-- ![](Figs/datadir.jpg){ width=40% } -->

There are two folders that need to be copied into the ACLIM2 folder on your computer under ``~[YOURPATH]/ACLIM2/Data/in/`:

1) [**00_ACLIM_shared>02_DATA>Newest**](https://drive.google.com/drive/u/0/folders/0Bx7wdZllbuF9eDJndkhCS2EwQUk "00_ACLIM_shared>02_DATA>Newest"). This folder contains a folder called `roms_for_aclim` with all the ACLIM Level3 indices for model simulations available to ACLIM members.

2) [**00_ACLIM_shared>02_DATA>Map_layers.zip**](https://drive.google.com/drive/u/0/folders/0Bx7wdZllbuF9eDJndkhCS2EwQUk "00_ACLIM_shared>02_DATA>Map_layers"). This file needs to be unzipped after you download it to your local folder. It contains (large) base maps for the code below including `shp_files` and `geo_tif` folders.

![Your local `ACLIM2/Data` directory should look something like this when you are done downloading the data and unzipping it.](Figs/data_dir.jpg){ width=65% }

### 2.3.2 Option 2: Download from web-based database

This option is available for Level3 and Level 2 CMIP5 public data, it is not yet available for the embargoed CMIP6 data but eventually will be used to host that as well.

The ROMSNPZ team has been working with [Roland Schweitzer](roland.schweitzer@noaa.gov) and [Peggy Sullivan](peggy.sullivan@noaa.gov) to develop the ACLIM Live Access Server (LAS) to publicly host the published CMIP5 hindcasts and downscaled projections. This server is in beta testing phase and can be accessed at the following links:

#### [THREDDS ACLIM data access tool](https://data.pmel.noaa.gov/aclim/thredds/)

Let's try downloading level 3 layers from the Thredds online CMIP5 catalog:

```{r thredds,include=TRUE, eval = FALSE,echo = FALSE}
#paged
# https://rdrr.io/github/bocinsky/thredds/f/README.md
# https://publicwiki.deltares.nl/display/OET/OPeNDAP+access+with+R



    tmstp  <- format(Sys.time(), "%Y_%m_%d")
    main   <- getwd()  #"~/GitHub_new/ACLIM2"
    
    # loads packages, data, setup, etc.
    source("R/make.R") 
    
    year <- 2040
    as.Date(3907,origin)
    origin <- "1900-01-01 00:00:00"

    
    # define the simulation to download:
    cmip <- "CMIP5"
    GCM  <- "MIROC"
    rcp  <- "rcp85"
    sim  <- paste0("B10K-H16_",cmip,"_",GCM,"_",rcp,"/")
    base_url_l2 <- "https://data.pmel.noaa.gov/aclim/thredds/dodsC/Level2/"
       ACLIMsurveyrep_B10K-H16_CMIP5_CESM_rcp45.nc	29.90 Mbytes	2021-01-15T18:58:01Z
         ACLIMregion_B10K-H16_CMIP5_CESM_rcp45.nc
         
         
    url    <- "https://data.pmel.noaa.gov/aclim/thredds/dodsC/Level2/B10K-H16_CMIP5_CESM_rcp45_bottom5m.nc"
    sim_url <- basename(url)
    url_l3 <- "https://data.pmel.noaa.gov/aclim/thredds/dodsC/B10K-H16_CMIP5_CESM_rcp45/Level3/ACLIMsurveyrep_B10K-H16_CMIP5_CESM_rcp45.nc"
    
    nc <- nc_open(url)
nc <- nc_open(url_l3)
    
    # define the threddds url
    aclim_thredds <- "https://data.pmel.noaa.gov/aclim/thredds/"
    
    # preview the datasets on the server:
    url_list <- tds_list_datasets(thredds_url = aclim_thredds)
    
    # get the url for the target dataset:
    sim_url  <- url_list[url_list$dataset == sim,]$path
    sim_datasets <- tds_list_datasets(thredds_url = sim_url)
    
    l2_cat   <- sim_datasets[sim_datasets$dataset == "Level 2/",]$path
    l3_cat   <- sim_datasets[sim_datasets$dataset == "Level 3/",]$path
    l2_data  <- tds_list_datasets(l2_cat)
    
    l2_url   <- l2_data[l2_data$dataset == "Bottom 5m",]$path
    vars     <- tds_ncss_list_vars(ncss_url = l2_url)
    url <- l2_url
  
    #l3_data  <- tds_list_datasets(l3_cat)

# open the downloaded nc file:
grid.nc <- nc_open(nc_file)


sim_services <- aclim_list_services(sim_url,lvl=3)
sim_services

sim_ncss <- aclim_list_services(sim_url,lvl=3)
sim_ncss <-"https://data.pmel.noaa.gov/aclim/thredds/catalog/B10K-H16_CMIP5_MIROC_rcp85/Level3/dataset.html"

loca_ncss <- loca_services[loca_services$service == "NetcdfSubset",]$path
loca_ncss
#> [1] "https://cida.usgs.gov/thredds/ncss/loca_future/dataset.html"

loca_vars <- tds_ncss_list_vars(ncss_url = sim_ncss)
loca_vars


CCSM4 <- tds_ncss_download(ncss_url = loca_ncss,
                           out_file = paste0(tempdir(),"/CCSM4.nc"),
                           bbox = sf::st_bbox(c(xmin = -116.5, xmax = -115, ymin = 44.5, ymax = 45)),
                           vars = c("tasmax_CCSM4_r6i1p1_rcp45","tasmax_CCSM4_r6i1p1_rcp85"),
                           ncss_args = list(temporal = "all"))

# open the downloaded nc file:
grid.nc <- nc_open(nc_file)

url_grid <-
"http://opendap.deltares.nl/thredds/fileServer/opendap/rijkswaterstaat/vaklodingen/vaklodingenKB116_4544.nc" # note: netcdf4 does not work on windows R
 
url_time <-
"http://opendap.deltares.nl/thredds/fileServer/opendap/rijkswaterstaat/waterbase/concentration_of_suspended_matter_in_sea_water/id410-DELFZBTHVN.nc"
lvl2_url_grid <- "https://data.pmel.noaa.gov/aclim/thredds/dodsC/Level2/B10K-H16_CMIP5_CESM_BIO_rcp85_bottom5m.nc?Cs_r,hc,lat_rho[0:1:257][0:1:181],lon_rho[0:1:257][0:1:181],s_rho,ocean_time[0:1:4901],temp[0:1:4901][0:1:257][0:1:181]"

lvl2_url_grid <-"https://data.pmel.noaa.gov/aclim/thredds/dodsC/Level2/B10K-H16_CMIP5_CESM_rcp45_bottom5m.nc?temp[0:1:2][0:1:257][0:1:181]"

GET_lv2 <- function( ncss_url, out_file, bbox, vars = NULL, ncss_args = NULL, 
          overwrite = TRUE
){
  
  base_url <- ncss_url %>% stringr::str_remove("([^/]+$)") %>% 
    stringr::str_remove("(\\/+$)")
  if (is.null(vars)) {
    vars <- tds_ncss_list_vars(ncss_url)
  }
  query <- list(var = vars %>% stringr::str_c(collapse = ","), 
                north = bbox[["ymax"]], west = bbox[["xmin"]], east = bbox[["xmax"]], 
                south = bbox[["ymin"]])
  
  
}
query <- "B10K-H16_CMIP5_CESM_rcp45_bottom5m.nc?temp[0:1:2][0:1:257][0:1:181]"
httr::GET(base_url, query = query, httr::write_disk(out_file,overwrite = overwrite), ...)


lvl2_url_grid <-"https://data.pmel.noaa.gov/aclim/thredds/dodsC/Level2/B10K-H16_CMIP5_CESM_rcp45_bottom5m.nc?temp[0:1:1][0:1:257][0:1:181]"

grid<-"https://data.pmel.noaa.gov/aclim/thredds/dodsC/Level2/B10K-H16_CMIP5_CESM_rcp45_surface5m.nc?temp[0:1:2][0:1:257][0:1:181]"
base_url <- "https://data.pmel.noaa.gov/aclim/thredds/dodsC/Level2/B10K-H16_CMIP5_CESM_rcp45_surface5m.nc"
query <-"temp[0:1:2][0:1:257][0:1:181]"
out_file <- nc_file
overwrite <- TRUE
httr::GET(base_url, query = query, httr::write_disk(out_file,overwrite = overwrite), ...)

nc <- nc_open(nc_file)


download.file(grid, nc_file, method = "auto",
quiet = FALSE, mode="wb", cacheOK = TRUE)
 
download.file(url_time, "id410-DELFZBTHVN.nc", method = "auto",
quiet = FALSE, mode="wb", cacheOK = TRUE)




tmstp  <- format(Sys.time(), "%Y_%m_%d")
main   <- getwd()  #"~/GitHub_new/ACLIM2"

# loads packages, data, setup, etc.
source("R/make.R")
if(!dir.exists("Data/in/Thredds")) dir.create("Data/in/Thredds")

ACLIM_data_url <- "https://data.pmel.noaa.gov/aclim/thredds/"

lv3 <- paste0(ACLIM_data_url,"catalog/B10K-H16_CMIP5_CESM_BIO_rcp85/Level3/catalog.html?dataset=B10K-H16_CMIP5_CESM_BIO_rcp85/Level3/ACLIMsurveyrep_B10K-H16_CMIP5_CESM_BIO_rcp85.nc")

lv3 <- " /aclim/thredds/dodsC/B10K-H16_CMIP5_CESM_BIO_rcp85/Level3/ACLIMsurveyrep_B10K-H16_CMIP5_CESM_BIO_rcp85.nc"
lv3 <- "https://data.pmel.noaa.gov/aclim/thredds/dodsC/B10K-H16_CMIP5_CESM_BIO_rcp85/Level3/ACLIMsurveyrep_B10K-H16_CMIP5_CESM_BIO_rcp85.nc"
lv3 <- "https://data.pmel.noaa.gov/aclim/thredds/dodsC/B10K-H16_CMIP5_CESM_BIO_rcp85/Level3/ACLIMsurveyrep_B10K-H16_CMIP5_CESM_BIO_rcp85.nc?year[0:1:130],station_id[0:1:508],latitude[0:1:508],longitude[0:1:508],stratum[0:1:508],doy[0:1:508],temp_bottom5m[0:1:130][0:1:508]"

lv3 <- "https://data.pmel.noaa.gov/aclim/erddap/tabledap/B10K-H16_CORECFS_Level3_regions.htmlTable?time%2Cregion%2Cregion_area%2CBen%2CDetBen%2CHsbl%2CIceNH4%2CIceNO3%2CIcePhL%2Caice%2Chice%2Cshflux%2Cssflux%2CCop_integrated%2CCop_surface5m%2CEupO_integrated%2CEupO_surface5m%2CEupS_integrated%2CEupS_surface5m%2CIron_bottom5m%2CIron_integrated%2CIron_surface5m%2CJel_integrated%2CJel_surface5m%2CMZL_integrated%2CMZL_surface5m%2CNCaO_integrated%2CNCaO_surface5m%2CNCaS_integrated%2CNCaS_surface5m%2CNH4_bottom5m%2CNH4_integrated%2CNH4_surface5m%2CNO3_bottom5m%2CNO3_integrated%2CNO3_surface5m%2CPhL_integrated%2CPhL_surface5m%2CPhS_integrated%2CPhS_surface5m%2Cprod_Cop_integrated%2Cprod_EupO_integrated%2Cprod_EupS_integrated%2Cprod_Eup_integrated%2Cprod_Jel_integrated%2Cprod_MZL_integrated%2Cprod_NCaO_integrated%2Cprod_NCaS_integrated%2Cprod_NCa_integrated%2Cprod_PhL_integrated%2Cprod_PhS_integrated%2Csalt_surface5m%2Ctemp_bottom5m%2Ctemp_integrated%2Ctemp_surface5m%2CuEast_bottom5m%2CuEast_surface5m%2CvNorth_bottom5m%2CvNorth_surface5m%2Cfracbelow0%2Cfracbelow1%2Cfracbelow2%2Clongitude%2Clatitude&time%3E=2018-08-05T00%3A00%3A00Z&time%3C=2018-08-12T12%3A00%3A00Z"


  
url_lv3  <- "https://data.pmel.noaa.gov/aclim/thredds/dodsC/B10K-H16_CMIP5_MIROC_rcp85/Level3/ACLIMsurveyrep_B10K-H16_CMIP5_MIROC_rcp85.nc.html"
nc_file  <- "Data/in/Thredds/B10K-H16_CMIP5_MIROC_rcp45_bottom5m.nc"


# Download the file from the online REPO:
# download.file( lvl2_url_grid,
#                nc_file,
#                method="auto",quiet = FALSE, mode = "wb",cacheOK=TRUE)
junk <- GET(lvl2_url_grid, write_disk(nc_file, overwrite=TRUE), progress())


junk <- GET('https://oceanwatch.pifsc.noaa.gov/erddap/griddap/CRW_sst_v1_0_monthly.nc?analysed_sst[(2018-01-01T12:00:00Z):1:(2018-12-01T12:00:00Z)][(17):1:(30)][(195):1:(210)]', write_disk("sst.nc", overwrite=TRUE))


# open the downloaded nc file:
grid.nc <- nc_open(nc_file)

# look what's in there...
grid.nc

# Get grid data
G.x <- get.var.ncdf(grid.nc,'x')
G.y <- get.var.ncdf(grid.nc,'y')

# get only first timestep
G.z <- get.var.ncdf(grid.nc,'z')[,,1]

# to get a black background, and set the scale of depth values to start from 0.
G.z[G.z == -9999] <- 0

# image.plot needs sorted x- and y-values;
# as y-values are descending, the order is reversed here...
G.y <- rev(G.y)
G.z <- G.z[,length(G.y):1]
time.nc <- open.ncdf("id410-DELFZBTHVN.nc")
# look what's in there...
time.nc

T.t <- get.var.ncdf(time.nc,'time')
T.eta <-
  get.var.ncdf(time.nc,'concentration_of_suspended_matter_in_sea_water')
plot ...
# R-package fields provides nice image facilities and color schemes
par (mfrow = c(1,2))
library(fields)
image.plot(G.x,G.y,as.matrix(G.z),
           col = c(tim.colors(),"black"),
           xlab = "x [m]", ylab = "y [m]")
plot(as.Date(T.t, origin="1970-01-01"), T.eta, type = "l", ylab = "spm
[mg/l]")


```


#### [LAS custom ROMSNPZ data query, mapping, and plotting tool](https://data.pmel.noaa.gov/aclim/las/ "Live Access Server")

#### [ERDAPP ACLIM data access tool](https://data.pmel.noaa.gov/aclim/erddap/)



# 3. Exploring the ACLIM indices


The following examples show how to access and plot the ACLIM indices from their stored netcdf (.nc) format in the Data folder of the ACLIM shared google drive. Please note that while the CMIP5 set is now public (Hermann et al. 2019) **the CMIP6 suite is under embargo for QAQC and should not be shared outside of the ACLIM group**. Al, Wei, Kelly, Darren, and Kerim are in the process of synthesizing and publishing the CMIP6 data (goal is spring 2021 for submission), following those publications the data will be made accessible to the public via the PMEL data portal, as is the case for the CMIP5 data and public hindcasts. It is strongly recommended that you include at least one (ideally multiple) authors from the ROMSNPZ team as co-author on your paper if you are linking to this data, this is especially the case for the CMIP6 data. There are multiple spatial and temporal caveats that are best described in discussions with the authors of these data and inclusion as co-authors will facilitate appropriate application and interpretation of the ROMSNPZ data.


```{R get_level3, include=FALSE, echo=FALSE, eval=FALSE}
    tmstp  <- format(Sys.time(), "%Y_%m_%d")
    main   <- getwd()  #"~/GitHub_new/ACLIM2"
    
    # loads packages, data, setup, etc.
    source("R/make.R")   
  
    ### To re download data from mox (Kirstin) switch "redownload_level3_mox" to TRUE in setup.R
  
    # Accessing ROMSNPZ on mox (hyak UW)
    # If you have a UW ID and are authorized on 
    # hyak (can do this through myUW.com, under settings>computing):
  
    remote_main  <- "/gscratch/bumblereem/roms_for_public"  
    remotefolder  <- paste0("kkari@mox.hyak.uw.edu:",remote_main) 
   
    if(redownload_level3_mox){
    # This file downloads the .nc level 3 indices from MOX to the local drive
    #in terminal:
    # open new screen (ctrl A+D to exit; screen -r to return screen -ls to see list)
    ## screen 
    ## ssh kkari@mox.hyak.uw.edu
    ## password : J bday + Josie’s dog (cap S on both) +!! 
  
    # open terminal (faster) and copy the last line or run it in system
  
    # cat((paste0("rsync -avz --progress --include='**/Level*/*ACLIM*.nc' --include='*/' --exclude='*' ",remotefolder," ",localfolder)))
    # cat( (paste0("rsync -avz --progress --include='**/Level*/*ACLIM*.nc' --include='*/' --exclude='*' ",remotefolder," ",localfolder)))
   
    # doesn't like this in R (use copy paste into mox above)
     system( (paste0("rsync -avz --dry-run --include='**/Level*/*ACLIM*.nc' --include='*/' --exclude='*' ",remotefolder," ",localfolder)) )
    
   # system( (paste0("rsync -avz --progress ",remotefolder," ",localfolder)))
    
    system( (paste0("rsync -avz --progress --include='**/Level*/*ACLIM*.nc' --include='*/' --exclude='*' ",remotefolder," ",localfolder)))
  
  }
 
```

The naming convention of the folders is:
`B10K-[ROMSNPZ version]_[CMIP]_[GCM]_[carbon scenario]`.For example, the CMIP5 set of indices was downscaled using the H16 (Hermann et al. 2016) version of the ROMSNPZ. Three models were used to force boundary conditions( MIROC, CESM, and GFDL) under 2 carbon scenarios RCP 8.5 and RCP 4.5. So to see an individual trajectory we might look in the level3 (timeseries indices) folder under `B10K-H16_CMIP5_CESM_rcp45`, which would be the B10K version H16 of the CMIP5 CESM model under RCP4.5.

## 3.1. Set up the R Workspace and explore the two ACLIM Level3 indices types:

The following `make.R` script will load the directory paths, preferences, packages, and based functions into R().
```{r setupL3, eval=F, echo=T}

    tmstp  <- format(Sys.time(), "%Y_%m_%d")
    main   <- getwd()  #"~/GitHub_new/ACLIM2"
    
    # loads packages, data, setup, etc.
    source("R/make.R")
    
```

Once the base files and setup are loaded you can explore the index types. Recall that in each scenario folder there are two indices saved within the `Level3` subfolders:

1) `ACLIMsurveyrep_B10K-x.nc` contains summer groundfish trawl "survey replicated" indices (using mean date and lat lon) *(Note that the resampling stations need to be removed before creating bottom temperature maps)*  
2) `ACLIMregion_B10K-x.nc`: contains weekly "strata" values *(Note that area weighting should be used to combine values across multiple strata)*

```{r explore, eval=F, echo=T}

    # list of the scenario x GCM downscaled ACLIM indices
    for(k in aclim)
     cat(paste(k,"\n"))
    
    embargoed # not yet public or published
    public    # published runs (CMIP5)
    
    # get some info about a scenario:
  
    all_info1 <- info(model_list=aclim,type=1)
    all_info2 <- info(model_list=aclim,type=2)
    all_info1
    all_info2
   
    # variables in each of the two files:
    srvy_vars
    weekly_vars
  
    #summary tables for variables
    srvy_var_def
    weekly_var_def
 
```
 
## 3.2. Explore "survey replicated" `.nc` files in R()

With the workspace setup the following code can be used to explore the ACLIM indices.The first indices we will explore are the survey replicated values for each variable. These are stored in the `ACLIMsurveyrep_B10K-[version_CMIPx_GCM_RCP].nc` in each scenario folder. 

![Survey replicated stations.](Figs/stations.jpg){ width=30%}

The code segment below will recreate the above figure 2.
```{r readncfiles_srvy, eval=F, echo=T}
 
   # explore stations in the survey replicated data:
   station_info
  
   # first convert the station_info object into a shapefile for mapping:
   station_sf         <- convert2shp(station_info)
   station_sf$stratum <- factor(station_sf$stratum)
   
   # plot the stations:
   p <- plot_stations_basemap(sfIN = station_sf,fillIN = "subregion",colorIN = "subregion") + 
     scale_color_viridis_d(begin = .4,end=.6) +
     scale_fill_viridis_d(begin = .4,end=.6)
   p
   
   p2 <- plot_stations_basemap(sfIN = station_sf,fillIN = "stratum",colorIN = "stratum") + 
     scale_color_viridis_d() +
     scale_fill_viridis_d()
   p2
   
   if(update.figs)  ggsave(file="Figs/stations.jpg",width=5,height=5)
 
```

Now let's explore the survey replicated data in more detail and use it to create a cold pool index for each simulation and hindcast scenario x model x CMIP combination.

```{r explore_srvy, eval=F, echo=T}

    # now create plots of average BT during four time periods
    time_seg   <- list('2010-2020' = c(2010:2020),
                        '2021-2040' = c(2021:2040),
                        '2041-2060' = c(2041:2060),
                        '2061-2080' = c(2061:2080),
                        '2081-2099' = c(2081:2099))
  
    # View an individual variable (e.g., Bottom Temp)
    # -------------------------------------------------------
    srvy_vars
    aclim
    sim <- aclim[2]
    # open a "region" or strata specific nc file
    ncfl      <- file.path(sim,paste0(srvy_txt,sim,".nc"))
    nc        <- nc_open(file.path(data_path,ncfl))
    
    # convert the nc files into a data.frame
    tmp_var    <- convert2df(ncIN = nc, type = 2, varIN = "temp_bottom5m")
    head(tmp_var)
    nc_close(nc)
    
    
    # Collate mean values across timeperiods and simulations
    # -------------------------------------------------------
    m_set      <- c(18,19);aclim[m_set]
    mn_var_all <- get_mn_srvy_var(modset = aclim[m_set],varUSE="temp_bottom5m")
    mn_var_sf  <- convert2shp(mn_var_all%>%filter(!is.na(mnval)))
   
    p3         <- plot_stations_basemap(sfIN = mn_var_sf,
                                fillIN = "mnval",
                                colorIN = "mnval",
                                sizeIN=.3) +
      facet_grid(simulation~time_period)+
      scale_color_viridis_c()+
      scale_fill_viridis_c()+
      guides(
        color =  guide_legend(title="Bottom T (degC)"),
        fill  =  guide_legend(title="Bottom T (degC)")) +
      ggtitle(substr(aclim[m_set[1]],1,23))
   
    # This is slow but it works (repeat dev.new() twice if in Rstudio)...
    dev.new()
    p3
    
    if(update.figs)  ggsave(file="Figs/mn_BT.jpg",width=8,height=5)
  
    graphics.off()
 
```


![Bottom temperature projections under differing SSP126 (top row) and SSP585 (bottom row)](Figs/mn_BT.jpg)  

## 3.3. Explore "weekly strata" `.nc` files in R()

The next set of indices to will explore are the weekly strata-specific values for each variable.These are stored in the `ACLIMregion_B10K-[version_CMIPx_GCM_RCP].nc` in each scenario folder. 

```{r readncfiles_weekly, eval=F, echo=T}
    # list of the scenario x GCM downscaled ACLIM indices
    for(k in aclim)
      cat(paste(k,"\n")

    # View an individual variable (e.g., Bottom Temp)
    # -------------------------------------------------------
    weekly_vars
    aclim
    sim <- aclim[2]
    # open a "region" or strata specific nc file
    ncfl      <- file.path(sim,paste0(reg_txt,sim,".nc"))
    nc        <- nc_open(file.path(data_path,ncfl))
    
    # convert the nc files into a data.frame
    tmp_var    <- convert2df(ncIN = nc, type = 1, varIN = "temp_bottom5m")
    head(tmp_var)
    nc_close(nc)
    
  
   # now plot the data:
   
   p4 <- ggplot(data = tmp_var) + 
     geom_line(aes(x=time,y=val,color= strata),alpha=.8)+
     facet_grid(basin~.)+
     ylab(tmp_var$units[1])+
     ggtitle(substr( aclim[i],18,nchar( aclim[i])-3))+
     theme_minimal()
   p4
   
   # To get the average value for a set of strata, weight the val by the area:
   mn_NEBS <- getAVGnSUM(strataIN = NEBS_strata, dataIN = tmp_var)
   mn_NEBS$basin = "NEBS"
   mn_SEBS <-getAVGnSUM(strataIN = SEBS_strata, dataIN = tmp_var)
   mn_SEBS$basin = "SEBS"
   
   p5 <- ggplot(data = rbind(mn_NEBS,mn_SEBS)) + 
      geom_line(aes(x=time,y=mn_val,color=basin),alpha=.8)+
      geom_smooth(aes(x=time,y=mn_val,color=basin),
                  formula = y ~ x, se = T)+
      facet_grid(basin~.)+
      scale_color_viridis_d(begin=.4,end=.8)+
      ylab(tmp_var$units[1])+
      ggtitle( paste(aclim[2],mn_NEBS$var[1]))+
      theme_minimal()
  p5
  if(update.figs)  ggsave(file="Figs/weekly_byreg.jpg",width=8,height=5)

 
```


![Weekly indcices by sub-region](Figs/weekly_byreg.jpg){ width=65% }

### 2.2.4 Create seasonal averages  

Now using a similar approach get the monthly mean values for a variable:
```{r seasonal averages, eval=F, include=T,echo=T}
    
    # Set up seasons (this follows Holsman et al. 2020)
    seasons <- data.frame(mo = 1:12, season =factor("",levels=c("Winter","Spring","Summer","Fall")))
      seasons$season[1:3]   <- "Winter"
      seasons$season[4:6]   <- "Spring"
      seasons$season[7:9]   <- "Summer"
      seasons$season[10:12] <- "Fall"

    # open a "region" or strata specific nc file
    ncfl      <- file.path(sim,paste0(reg_txt,sim,".nc"))
    nc        <- nc_open(file.path(data_path,ncfl))
    
    # convert the nc files into a data.frame
    tmp_var0    <- convert2df(ncIN = nc, type = 1, varIN = "temp_bottom5m")
    tmp_var1    <- convert2df(ncIN = nc, type = 1, varIN = "NCaS_integrated")  # Large Cop
    tmp_var2    <- convert2df(ncIN = nc, type = 1, varIN = "Cop_integrated")   # Small Cop
    tmp_var3    <- convert2df(ncIN = nc, type = 1, varIN = "EupS_integrated")  # Euphausiids
    
    tmp_var     <- merge(tmp_var1,tmp_var3, by=c("strata","strata_area_km2","time","basin"))
    # include tmp_var2 if looking at all cop, here we just do largeZoop
    # tmp_var     <- merge(tmp_var,tmp_var2, by=c("strata","strata_area_km2","time","basin"))
    tmp_var     <- tmp_var%>%group_by(time,strata,strata_area_km2,basin)%>%
      mutate(val      = val.x + val.y ,units = units.x,
             var       = "Zoop_integrated",
             long_name ="Total On-shelf large zooplankton concentration, integrated over depth (NCa, Eup)")%>%
      select(time,strata,strata_area_km2,basin,var,val, units,long_name)
    head(tmp_var)
    
    nc_close(nc)
    
    tmp_var$yr     <- strptime(as.Date(tmp_var$time),format="%Y-%m-%d")$year + 1900
    tmp_var$mo     <- strptime(as.Date(tmp_var$time),format="%Y-%m-%d")$mon  + 1
    tmp_var$jday   <- strptime(as.Date(tmp_var$time),format="%Y-%m-%d")$yday + 1
    tmp_var$season <- seasons[tmp_var$mo,2]
    
    # To get the average value for a set of strata, weight the val by the area: (slow...)
    mn_NEBS_season <- getAVGnSUM(strataIN = NEBS_strata, dataIN = tmp_var,tblock=c("yr","season"))
    mn_NEBS_season$basin = "NEBS"
    mn_SEBS_season <- getAVGnSUM(strataIN = SEBS_strata, dataIN = tmp_var,tblock=c("yr","season"))
    mn_SEBS_season$basin = "SEBS"
    
    plot_data      <- rbind(mn_NEBS_season,mn_SEBS_season)
    
   # plot Fall values:
   p6 <- ggplot(data = plot_data%>%filter(season=="Fall") ) + 
      geom_line(   aes(x = yr,y = mn_val,color=basin),alpha=.8)+
      geom_smooth( aes(x = yr,y = mn_val,color=basin),
                  formula = y ~ x, se = T)+
      facet_grid(basin~.)+
      scale_color_viridis_d(begin=.4,end=.8)+
      ylab(tmp_var$units[1])+
      ggtitle( paste(aclim[2],"Fall",mn_NEBS_season$var[1]))+
      theme_minimal()
  p6
  
  
  if(update.figs)  ggsave(file="Figs/Fall_large_Zoop.jpg",width=8,height=5)
```

![Large fall zooplankton integrated concentration](Figs/Fall_large_Zoop.jpg){ width=65% }

### 2.2.5 Create monthly averages
Using the same approach we can get monthly averages for a given variable:

```{r monthly averages, eval=F, include=T,echo=T}
    
    # To get the average value for a set of strata, weight the val by the area: (slow...)
    mn_NEBS_season <- getAVGnSUM(strataIN = NEBS_strata, dataIN = tmp_var,tblock=c("yr","mo"))
    mn_NEBS_season$basin = "NEBS"
    mn_SEBS_season <- getAVGnSUM(strataIN = SEBS_strata, dataIN = tmp_var,tblock=c("yr","mo"))
    mn_SEBS_season$basin = "SEBS"
    
    plot_data      <- rbind(mn_NEBS_season,mn_SEBS_season)
    
   # plot Fall values:
   p7 <- ggplot(data = plot_data%>%filter(mo==9) ) + 
      geom_line(   aes(x = yr,y = mn_val,color=basin),alpha=.8)+
      geom_smooth( aes(x = yr,y = mn_val,color=basin),
                  formula = y ~ x, se = T)+
      facet_grid(basin~.)+
      scale_color_viridis_d(begin=.4,end=.8)+
      ylab(tmp_var$units[1])+
      ggtitle( paste(aclim[2],"Sept.",mn_NEBS_season$var[1]))+
      theme_minimal()
  p7
  
  if(update.figs)  ggsave(file="Figs/Sept_large_Zoop.jpg",width=8,height=5)
  
```

![September large zooplankton integrated concentration](Figs/Sept_large_Zoop.jpg){ width=65% }


<!-- ### 2.2.6 Create the ACLIM annual indices of seasonal and survey replicated values -->
<!-- ```{r} -->

<!-- ``` -->

<!-- ### 2.2.7. Save ACLIM indices as Rdata object in `Data/out` folder. -->

<!-- ```{r} -->

<!-- ``` -->


# 4. Funding and acknowledgments (needs updating):

### PLEASE Include a statement like the following one in your acknowledgements section:

*This study is part of NOAA’s Alaska Climate Integrated Modeling project (ACLIM) and FATE project XXXX. We would like to that the entire ACLIM team including `[add specific names]` for feedback and discussions on the broader application of this work. Multiple NOAA National Marine Fisheries programs provided support for ACLIM including Fisheries and the Environment (FATE), Stock Assessment Analytical Methods (SAAM) Science and Technology North Pacific Climate Regimes and Ecosystem Productivity, the Integrated Ecosystem Assessment Program (IEA), the NOAA Economics and Social Analysis Division, NOAA Research Transition Acceleration Program (RTAP), the Alaska Fisheries Science Center (ASFC), the Office of Oceanic and Atmospheric Research (OAR) and the National Marine Fisheries Service (NMFS). The scientific views, opinions, and conclusions expressed herein are solely those of the authors and do not represent the views, opinions, or conclusions of NOAA or the Department of Commerce.*

### For some of the integrated papers the following maybe should also be added:

*Additionally, the International Council for the Exploration of the Sea (ICES) and the North Pacific Marine Science Organization (PICES) provided support for Strategic Initiative for the Study of Climate Impacts on Marine Ecosystems (SI-CCME) workshops, which facilitated development of the ideas presented in this paper. The scientific views, opinions, and conclusions expressed herein are solely those of the authors and do not represent the views, opinions, or conclusions of NOAA, the Department of Commerce, ICES, or PICES.*



# 5. Helpful links and further reading:  

## 5.1 Citations for GCMs and carbon scenarios:

### CMIP3 (BSIERP global climate model runs):
Meehl, G. A., C. Covey, T. Delworth, M. Latif, B. McAvaney, J. F. B. Mitchell, R. J. Stouffer, and K. E. Taylor, 2007: The WCRP CMIP3 multimodel dataset: A new era in climate change research. Bull. Amer. Meteor. Soc., 88, 1383–1394.

### CMIP5 (ACLIM global climate model runs):
Taylor, K. E., R. J. Stouffer, and G. A. Meehl, 2012:Anoverview of CMIP5 and the experiment design. Bull. Amer. Meteor. Soc., 93, 485–498.

### CMIP6 and SSPs (ACLIM2 global climate model runs):
ONeill, B. C., C. Tebaldi, D. P. van Vuuren, V. Eyring, P. Friedlingstein, G. Hurtt, R. Knutti, E. Kriegler, J.-F. Lamarque, J. Lowe, G. A. Meehl, R. Moss, K. Riahi, and B. M. Sanderson. 2016. The Scenario Model Intercomparison Project (ScenarioMIP) for CMIP6. Geoscientific Model Development 9:3461–3482.



## 5.2 Weblinks for further reading:

* Explore annual indices of downscaled projections for the EBS: [**ACLIM indices**](https://kholsman.shinyapps.io/aclim/ "ACLIM Shiny tool")

* To view climate change projections from CMIP5 (eventually CMIP6):[**ESRL climate change portal **](https://www.esrl.noaa.gov/psd/ipcc/ocn/ "ESRL climate change portal")


## 5.3 Additional information on Hindcast and Projection Models (needs updating)

### CORE-CFSR (1976-2012) 

This is the hindcast for the Bering Sea and is a combination of the reconstructed climatology from the [**CLIVAR**](http://portal.aoos.org/bering-sea.php#module-metadata/5626a0b6-7d79-11e3-ac17-00219bfe5678/0756e6c2-a8e2-40af-aa3d-22051ed68067) Co-ordinated Ocean-Ice Reference Experiments (CORE) Climate Model (1969-2006) the [**NCEP**](http://portal.aoos.org/bering-sea.php#module-metadata/f8cb79f6-7d59-11e3-a6ee-00219bfe5678/2deb2eca-f3f5-4eda-a132-112468711de7) Climate Forecast System Reanalysis is a set of re-forecasts carried out by NOAA's National Center for Environmental Prediction (NCEP). See [**CFS-R**](http://cfs.ncep.noaa.gov/cfsr/) for more info.

### [CCCMA](http://www.cccma.ec.gc.ca/diagnostics/cgcm3/cgcm3.shtml)(2006-2039; AR4 SRES A1B) 

Developed by the Canadian Centre for Climate Modelling and Analysis, this is also known as the CGCM3/T47 model. This model showed the greatest warming over time compared to other models tested by PMEL. See more data the [**AOOS:CCCMA portal**](http://portal.aoos.org/bering-sea.php#module-metadata/4f706756-7d57-11e3-bce5-00219bfe5678/ffa1bcc1-288d-4f8e-912e-500a618b241a).

### [ECHOG](http://www-pcmdi.llnl.gov/ipcc/model_documentation/ECHO-G.pdf)(2006-2039; AR4 SRES A1B)
The ECHO-G model from the Max Planck Institute in Germany This model showed the least warming over time compared to other models tested by PMEL. See more data the <a href="http://portal.aoos.org/bering-sea.php#module-metadata/18ffa59c-7d7a-11e3-82a4-00219bfe5678/f2e5592b-28d2-483d-8ef8-52aa18f6e3dc">AOOS:ECHO-G portal</a>.

### [GFDL](http://www.gfdl.noaa.gov/earth-system-model) (2006-2100; AR5 RCP 4.5, 8.5, SSP126,SSP585) 

The NOAA Geophysical Fluid Dynamics Laboratory [**GFDL**](http://www.gfdl.noaa.gov) has lead development of the first Earth System Models (ESMs), which like physical climate models, are based on an atmospheric circulation model coupled with an oceanic circulation model, with representations of land, sea ice and iceberg dynamics; ESMs additionally incorporate interactive biogeochemistry, including the carbon cycle. The ESM2M model used in this project is an evolution of the prototype EMS2.1 model, where pressure-based vertical coordinates are used along the developmental path of GFDL's Modular Ocean Model version 4.1 and where the land model is more adavanced (LM3) than in the previous ESM2.1

### [MIROC](www.cger.nies.go.jp/publications/report/i073/I073.pdf)(2006-2039; AR4 SRES A1B; 2006-2100 RCP4.5, RCP8.5, SSP585, SSP126) 

The Model for Interdisciplinary Research on Climate (MIROC)-M model developed by a <a href="www.cger.nies.go.jp">consortium of agencies in Japan</a> []. Compared to other models tested by PMEL, MIROC-M was intermediate in degree of warming over the Bering Sea shelf for the first half of the 21st century. See more data the <a href="http://portal.aoos.org/bering-sea.php#module-metadata/68ea728a-7d7a-11e3-823b-00219bfe5678/bb0d0b5e-878f-4ebb-8985-0d0e6aefe71f">AOOS:MIROC portal</a>.


<!-- ### ACLIM_data & ACLIM_scripts -->

<!-- This folder contains the most recent queries from the BEAST based on the scripts in [ACLIM_scripts]("https://github.com/kholsman/ACLIM/ACLIM_scripts"). The queries create annual indices (e.g., mean summer bottom temperature for the EBS survey area) which are station specific(Station_modelname) and based on the mean sampling date for each station, or based on weekly values (under folder [weekly]("https://github.com/kholsman/ACLIM/ACLIM_data/ROMS_NPZ_queries/weekly"); are "clipped to the survey area"). -->
<!-- These indices were cleaned and aggregated in the .Rdata file `ROMSNPZ_indices.Rdata` using the script `createROMSNPZ.R`. -->


```{r makeReadME, echo=FALSE,eval=F}
 
 # copy and paste this into R window (won't work within markdown)
 rmd2md(rmd_fl = "GettingStarted_ACLIM_ROMSNPZ_2021",md_fl = "README")

```


