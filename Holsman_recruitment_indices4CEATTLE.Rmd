 ---
title: "K Holsman code for creating CEATTLE recruitment indices from ACLIM2 Level3 data"
author: "Kirstin Holsman"
output:
  pdf_document:
    fig_caption: yes
    fig_height: 4
    fig_width: 5
    highlight: tango
    keep_tex: yes
    latex_engine: xelatex
    toc: TRUE
  html_document:
    df_print: kable
    fig_caption: yes
    theme: flatly
  header-includes:
  - \usepackage{inputenc}
  - \usepackage{unicode-math}
  - \pagenumbering{gobble}
  word_document:
    fig_caption: yes
    fig_width: 4
    keep_md: yes
---

```{r startup, eval=T, echo=F}
 #source("R/make.R")       # loads packages, data, setup, etc.
 knitr::opts_chunk$set(echo = TRUE, fig.align="center")
 thisYr <- format(Sys.time(), "%Y")
 today  <- format(Sys.time(), "%b %d, %Y")
 
```


<!-- ```{r, echo=FALSE, fig.align='center'} -->
<!-- include_graphics("Figs/ACLIM_logo.jpg") -->
<!-- ``` -->


![.](Figs/ACLIM_logo.jpg){ width=20%}


#### [** Part of ACLIM Repo: github.com/kholsman/ACLIM2**](https://github.com/kholsman/ACLIM2 "ACLIM2 Repo")  
  Repo maintained by:  
  Kirstin Holsman  
  Alaska Fisheries Science Center  
  NOAA Fisheries, Seattle WA  
  **[kirstin.holsman@noaa.gov](kirstin.holsman@noaa.gov)**  
  *Last updated: `r today`*

# FOR INTERNAL ACLIM USE ONLY

# 1. Load ACLIM2 Level3 ROMSNPZ indices

## 1.1. Set up the R Workspace and explore the two ACLIM Level3 indices types:

The following `make.R` script will load the directory paths, preferences, packages, and based functions into R().
```{r setupL3, eval=F, echo=T}

    tmstp  <- format(Sys.time(), "%Y_%m_%d")
    main   <- getwd()  #"~/GitHub_new/ACLIM2"
    
    # loads packages, data, setup, etc.
    source("R/make.R")
    

    # list of the scenario x GCM downscaled ACLIM indices
    for(k in aclim)
     cat(paste(k,"\n"))
  
    embargoed # not yet public or published
    public    # published runs (CMIP5)
    
    # get some info about a scenario:
  
    all_info1 <- info(model_list=aclim,type=1)
    all_info2 <- info(model_list=aclim,type=2)
    all_info1
    all_info2
   
    # variables in each of the two files:
    srvy_vars
    weekly_vars
  
    #summary tables for variables
    srvy_var_def
    weekly_var_def
    
    # explore stations in the survey replicated data:
   station_info
  
   # first convert the station_info object into a shapefile for mapping:
   station_sf         <- convert2shp(station_info)
   station_sf$stratum <- factor(station_sf$stratum)
 
```
 

The code segment below will recreate the above figure 2.
```{r readncfiles_srvy, eval=F, echo=T}
 
   
   # plot the stations:
   p <- plot_stations_basemap(sfIN = station_sf,fillIN = "subregion",colorIN = "subregion") + 
     scale_color_viridis_d(begin = .4,end=.6) +
     scale_fill_viridis_d(begin = .4,end=.6)
   p
   
   p2 <- plot_stations_basemap(sfIN = station_sf,fillIN = "stratum",colorIN = "stratum") + 
     scale_color_viridis_d() +
     scale_fill_viridis_d()
   p2
   
```


