if(deletezip)
file.remove(destfile)
}
#'
#'
#'Get_map_layers.R
#'
# set up folders:
# ---------------------------------
fldrs<-c(file.path(mapdata_path,"shp_files"),
file.path(mapdata_path,"shp_files/global"),
file.path(mapdata_path,"shp_files/global/natural_earth_vector"),
file.path(mapdata_path,"geo_tif"),
file.path(mapdata_path,"geo_tif/OB_LR"))
for(ddir in fldrs){
if(!dir.exists(ddir)) dir.create(ddir)
}
# download blue marble files:
# ---------------------------------
if(!file.exists(file.path(mapdata_path,"geo_tif/blue_marble.tif") ))
download.file(
url ="https://eoimages.gsfc.nasa.gov/images/imagerecords/57000/57752/land_shallow_topo_8192.tif",
file.path(file.path(mapdata_path,"geo_tif/blue_marble.tif") ))
# download OB_LR
# ---------------------------------
#http://www.naturalearthdata.com/http//www.naturalearthdata.com/download/10m/raster/OB_LR.zip
# /Users/kholsman/GitHub_new/ACLIM2/Data/in/Map_layers/geo_tif/OB_LR
if(!file.exists(file.path(mapdata_path,"geo_tif/OB_LR") ))
getZip( url = "http://www.naturalearthdata.com/http//www.naturalearthdata.com/download/10m/raster/OB_LR.zip",
destfile = file.path(mapdata_path,"geo_tif/OB_LR.zip") )
## CNTR_RG_03M_2014
# ---------------------------------
#C NTR_RG_03M_2014
tmp_fldr <-  file.path(mapdata_path,"shp_files/global")
if(!dir.exists(file.path(mapdata_path,tmp_fldr,"CNTR_RG_03M_2014"))){
getZip(
url     = "https://dominicroye.github.io/files/CNTR_RG_03M_2014.zip",
destfile = file.path( tmp_fldr,"CNTR_RG_03M_2014.zip") )
}
# natural_earth_vector
# ---------------------------------
#10m
base_url <-"https://www.naturalearthdata.com/http//www.naturalearthdata.com/download/"
tmp_fldr <-  file.path(mapdata_path,"shp_files/global")
# https://www.naturalearthdata.com/http//www.naturalearthdata.com/download/10m/physical/10m_physical.zip
# https://www.naturalearthdata.com/http//www.naturalearthdata.com/download/50m/physical/50m_physical.zip
# https://www.naturalearthdata.com/http//www.naturalearthdata.com/download/110m/physical/110m_physical.zip
for(nn in c(10.50,110) ){
nm       <-  paste0(nn,"m/physical/",nn,"m_physical.zip")
outfl    <-  paste0("natural_earth_vector/",nn,"m_physical.zip")
if(!dir.exists(file.path(tmp_fldr,paste0("natural_earth_vector/",nn,"m_physical")  )))
getZip( url = paste0(base_url,nm), destfile = file.path(tmp_fldr,outfl) )
}
# natural earth shp downloads:
# ---------------------------------
base_url <-"https://www.naturalearthdata.com/http//www.naturalearthdata.com/download/10m/physical/"
tmp_fldr <-  file.path(mapdata_path,"shp_files/global")
tmpnms <- c("ne_10m_bathymetry_K_200","ne_10m_bathymetry_J_1000")
for(nm in tmpnms){
if(!dir.exists( file.path( tmp_fldr,nm)   ) )
getZip( url = paste0(base_url,paste0(nm,".zip" )),
destfile = file.path( tmp_fldr,paste0(nm,".zip" )) )
}
# set up folders:
# ---------------------------------
fldrs<-c(file.path(mapdata_path,"shp_files"),
file.path(mapdata_path,"shp_files/global"),
file.path(mapdata_path,"shp_files/global/natural_earth_vector"),
file.path(mapdata_path,"geo_tif"),
file.path(mapdata_path,"geo_tif/OB_LR"))
for(ddir in fldrs){
if(!dir.exists(ddir)) dir.create(ddir)
}
getwd()
dir(mapdata_path)
shp_dir,"global/natural_earth_vector/110m_physical")
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# unzip the .zip file
setwd(download_path)
unzip (dest_file, exdir = "./",overwrite = T)
#rename the unzipped folder from ACLIM2-main to ACLIM2
file.rename(paste0(main_nm,"-main"), main_nm)
setwd(main_nm)
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# unzip the .zip file
setwd(download_path)
unzip (dest_file, exdir = "./",overwrite = T)
#rename the unzipped folder from ACLIM2-main to ACLIM2
file.rename(paste0(main_nm,"-main"), main_nm)
setwd(main_nm)
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# unzip the .zip file
setwd(download_path)
unzip (dest_file, exdir = "./",overwrite = T)
#rename the unzipped folder from ACLIM2-main to ACLIM2
file.rename(paste0(main_nm,"-main"), main_nm)
setwd(main_nm)
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# unzip the .zip file
setwd(download_path)
unzip (dest_file, exdir = "./",overwrite = T)
#rename the unzipped folder from ACLIM2-main to ACLIM2
file.rename(paste0(main_nm,"-main"), main_nm)
setwd(main_nm)
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# unzip the .zip file
setwd(download_path)
unzip (dest_file, exdir = "./",overwrite = T)
#rename the unzipped folder from ACLIM2-main to ACLIM2
file.rename(paste0(main_nm,"-main"), main_nm)
setwd(main_nm)
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# unzip the .zip file
setwd(download_path)
unzip (dest_file, exdir = "./",overwrite = T)
#rename the unzipped folder from ACLIM2-main to ACLIM2
file.rename(paste0(main_nm,"-main"), main_nm)
setwd(main_nm)
# ----------------------------------------
# packages.R
# load or install packages
# subset of Holsman et al. 2020 ACLIM Simulations
# kirstin.holsman@noaa.gov
# updated 2020
# ----------------------------------------
lib_list <- c(
# these for reshaping and manipulating data:
"ncdf4",
"devtools",
# "ncfd",
"magrittr",
"httr",
"reshape",
"dplyr",
"purrr",
"readxl",
"tidyverse",
# these for ggplot mapping:
"raster",
"ggspatial",             # used for N arrow and scale bar
"sf",                    # used for shapefiles
"rnaturalearth",         # has more shapefiles; used to make the "world" object
"maps",                  # has some state shapefiles, need to be converted with st_as_sf
"akima",                 # Interpolation of Irregularly and Regularly Spaced Data
# markdown stuff:
"knitr",
"kableExtra",
# These for making plots:
"RColorBrewer",
"ggplot2",
"mgcv",
"cowplot",               #
"wesanderson",
"scales",
"ggforce",
"grid",
"processx",
"plotly",
"extrafont"
)
# Install missing libraries:
missing <- setdiff(lib_list, installed.packages()[, 1])
if (length(missing) > 0) install.packages(missing)
# Load libraries:
for(lib in lib_list)
eval(parse(text=paste("library(",lib,")")))
## same for git libraries
lib_list_git <- c(
"thredds")
missing <- setdiff(lib_list_git, installed.packages()[, 1])
if (length(missing) > 0) devtools::install_github("bocinsky/thredds")
# Load libraries:
for(lib in lib_list_git)
eval(parse(text=paste("library(",lib,")")))
lib_list_git
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# unzip the .zip file
setwd(download_path)
unzip (dest_file, exdir = "./",overwrite = T)
#rename the unzipped folder from ACLIM2-main to ACLIM2
file.rename(paste0(main_nm,"-main"), main_nm)
setwd(main_nm)
# copy and paste this into R window (won't work within markdown)
rmd2md(rmd_fl = "GettingStarted_ACLIM_ROMSNPZ_2021v2",md_fl = "README")
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# unzip the .zip file
setwd(download_path)
unzip (dest_file, exdir = "./",overwrite = T)
#rename the unzipped folder from ACLIM2-main to ACLIM2
file.rename(paste0(main_nm,"-main"), main_nm)
setwd(main_nm)
version()
?version
R.version()
R.version
raster::brick()
getZip <- function(url,destfile, destpath,deletezip=F){
download.file(url=url, destfile=destfile)
tmp_wd <- getwd()
tt     <- strsplit(destfile,"/")
setwd(paste0(tt[[1]][-length(tt[[1]])],collapse="/"))
unzip (destfile, exdir = "./",overwrite = T)
if(deletezip)
file.remove(destfile)
setwd(tmp_wd)
}
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# unzip the .zip file
setwd(download_path)
unzip (dest_file, exdir = "./",overwrite = T)
#rename the unzipped folder from ACLIM2-main to ACLIM2
file.rename(paste0(main_nm,"-main"), main_nm)
setwd(main_nm)
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# unzip the .zip file
setwd(download_path)
unzip (dest_file, exdir = "./",overwrite = T)
#rename the unzipped folder from ACLIM2-main to ACLIM2
file.rename(paste0(main_nm,"-main"), main_nm)
setwd(main_nm)
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# unzip the .zip file
setwd(download_path)
unzip (dest_file, exdir = "./",overwrite = T)
#rename the unzipped folder from ACLIM2-main to ACLIM2
file.rename(paste0(main_nm,"-main"), main_nm)
setwd(main_nm)
gewd()
setwd("/Users/kholsman/GitHub_new/ACLIM2/Data/in/Map_layers")
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# unzip the .zip file
setwd(download_path)
unzip (dest_file, exdir = "./",overwrite = T)
#rename the unzipped folder from ACLIM2-main to ACLIM2
file.rename(paste0(main_nm,"-main"), main_nm)
setwd(main_nm)
tmp_fldr <-  file.path(mapdata_path,"shp_files/global")
tmp_fldr
url     = "https://dominicroye.github.io/files/CNTR_RG_03M_2014.zip"
destfile = file.path( tmp_fldr,"CNTR_RG_03M_2014.zip")
# download the file
download.file(url=url, destfile=destfile)
getwd()
?unzip
# unzip it
unzip(zipfile=destfile,exdir = paste0(ex_dir,'/'),overwrite = T)
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# unzip the .zip file
setwd(download_path)
unzip (dest_file, exdir = "./",overwrite = T)
#rename the unzipped folder from ACLIM2-main to ACLIM2
file.rename(paste0(main_nm,"-main"), main_nm)
setwd(main_nm)
if(!dir.exists(ex_dir)) dir.create(ex_dir)
# unzip it
unzip(zipfile=file.path(tmp_wd,destfile),exdir = ".",overwrite = T)
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# unzip the .zip file
setwd(download_path)
unzip (dest_file, exdir = "./",overwrite = T)
#rename the unzipped folder from ACLIM2-main to ACLIM2
file.rename(paste0(main_nm,"-main"), main_nm)
setwd(main_nm)
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# unzip the .zip file
setwd(download_path)
unzip (dest_file, exdir = "./",overwrite = T)
#rename the unzipped folder from ACLIM2-main to ACLIM2
file.rename(paste0(main_nm,"-main"), main_nm)
setwd(main_nm)
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# unzip the .zip file
setwd(download_path)
unzip (dest_file, exdir = "./",overwrite = T)
#rename the unzipped folder from ACLIM2-main to ACLIM2
file.rename(paste0(main_nm,"-main"), main_nm)
setwd(main_nm)
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# unzip the .zip file
setwd(download_path)
unzip (dest_file, exdir = "./",overwrite = T)
#rename the unzipped folder from ACLIM2-main to ACLIM2
file.rename(paste0(main_nm,"-main"), main_nm)
setwd(main_nm)
unzip (dest_file, exdir = "./",overwrite = T)
getwd()
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# unzip the .zip file
setwd(download_path)
unzip (dest_file, exdir = "./",overwrite = T)
#rename the unzipped folder from ACLIM2-main to ACLIM2
file.rename(paste0(main_nm,"-main"), main_nm)
setwd(main_nm)
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# unzip the .zip file
setwd(download_path)
unzip (dest_file, exdir = "./",overwrite = T)
#rename the unzipped folder from ACLIM2-main to ACLIM2
file.rename(paste0(main_nm,"-main"), main_nm)
setwd(main_nm)
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# unzip the .zip file
setwd(download_path)
unzip (dest_file, exdir = "./",overwrite = T)
#rename the unzipped folder from ACLIM2-main to ACLIM2
file.rename(paste0(main_nm,"-main"), main_nm)
setwd(main_nm)
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# unzip the .zip file
setwd(download_path)
unzip (dest_file, exdir = "./",overwrite = T)
#rename the unzipped folder from ACLIM2-main to ACLIM2
file.rename(paste0(main_nm,"-main"), main_nm)
setwd(main_nm)
dir("./")
getwd()
dir("././")
dir("./")
dir("../")
dir("./")
file.path(tmp_wd,ex_dir)
mapdata_path
mapdata_path     <- file.path(main,"Data/in/Map_layers")
mapdata_path
# Specify the download directory
main_nm       <- "ACLIM2"
download_path <- path.expand("~/desktop")
dest_fldr     <- file.path(download_path,main_nm)
url           <- "https://github.com/kholsman/ACLIM2/archive/main.zip"
dest_file     <- file.path(download_path,paste0(main_nm,".zip"))
download.file(url=url, destfile=dest_file)
# unzip the .zip file
setwd(download_path)
unzip (dest_file, exdir = "./",overwrite = T)
#rename the unzipped folder from ACLIM2-main to ACLIM2
file.rename(paste0(main_nm,"-main"), main_nm)
setwd(main_nm)
rm(list=ls())
rm(list=ls())
